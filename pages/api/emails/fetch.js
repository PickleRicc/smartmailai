/**
 * Email Fetching API Endpoint
 * 
 * Handles:
 * - Fetching emails from Gmail/Outlook
 * - Storing email metadata in Supabase
 * - Pagination and filtering
 * - Error handling for rate limits and token expiration
 * 
 * Returns: Paginated email data with categorization
 */